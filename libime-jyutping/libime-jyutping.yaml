name: libime-jyutping
buildsystem: cmake
build-options:
  prefix: /app/addons/Jyutping
  prepend-pkg-config-path: /app/addons/Jyutping/lib/pkgconfig
config-opts:
  - -DCMAKE_PREFIX_PATH=/app/addons/ChineseAddons
  - -DENABLE_TEST=OFF
post-install:
  - cp /app/addons/ChineseAddons/bin/libime_{history,prediction,slm_build_binary} /app/addons/Jyutping/bin/
  - cp --no-dereference /app/addons/ChineseAddons/lib/libIMECore.so* /app/addons/Jyutping/lib/
sources:
  - type: archive
    url: https://download.fcitx-im.org/fcitx5/libime-jyutping/libime-jyutping-1.0.3_dict.tar.xz
    sha256: a8a07ff447cb3a06e680d5627b9ea6ba5d31a02319e8d4fb4eab33e9feff017e
    x-checker-data:
      type: anitya
      project-id: 242972
      stable-only: true
      url-template: https://download.fcitx-im.org/fcitx5/libime-jyutping/libime-jyutping-${version}_dict.tar.xz
  - type: patch
    path: 0001-Set-LibIME-data-dirs-after-loading-LibIMECore.patch
