app-id: org.fcitx.Fcitx5
branch: stable
base: io.qt.qtwebengine.BaseApp
base-version: 5.15-21.08
runtime: org.kde.Platform
runtime-version: 5.15-21.08
sdk: org.kde.Sdk
add-extensions:
  org.fcitx.Fcitx5.Addon:
    version: stable
    directory: addons
    subdirectories: true
    no-autodownload: true
    add-ld-path: lib
    autodelete: true
separate-locales: false
command: fcitx5
finish-args:
  - --socket=session-bus
  - --socket=x11
  - --socket=wayland
  - --share=network
  - --filesystem=xdg-config/fcitx5:create
  - --filesystem=xdg-data/fcitx5:create
  - --filesystem=xdg-config/fontconfig:ro
  - --filesystem=xdg-config/fcitx:create
  - --filesystem=xdg-config/ibus:create
  - --device=dri
modules:
  - modules/fmt.yaml
  - modules/xcb-imdkit.yaml
  - modules/libevent.yaml
  - modules/json-c.yaml

  - name: cldr-emoji-annotation
    sources:
      - type: archive
        url: https://github.com/fujiwarat/cldr-emoji-annotation/releases/download/37.0_13.0_0_2/cldr-emoji-annotation-37.0_13.0_0_2.tar.gz
        sha256: 7a24ea3dc17b814fbe8ee1127e1036679098ef2991b9266d738d375554210d13
        x-checker-data:
          type: anitya
          project-id: 13423
          stable-only: true
          url-template: https://github.com/fujiwarat/cldr-emoji-annotation/releases/download/$version/cldr-emoji-annotation-$version.tar.gz
  - name: fcitx5
    buildsystem: cmake-ninja
    config-opts:
      - -DUSE_SYSTEMD=Off
      - -DENABLE_ENCHANT=Off
      - -DUSE_FLATPAK_ICON=On
    sources:
      - type: archive
        url: https://github.com/fcitx/fcitx5/archive/5.0.15/fcitx5-5.0.15.tar.gz
        sha256: 11d077b6f92d0279cae93e889a4c9efe7408e50420d17a90c6c20322b05c27f4
        x-checker-data:
          type: anitya
          project-id: 138232
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5/archive/$version/fcitx5-$version.tar.gz
      - type: file
        url: https://download.fcitx-im.org/data/en_dict-20121020.tar.gz
        sha256: c44a5d7847925eea9e4d2d04748d442cd28dd9299a0b572ef7d91eac4f5a6ceb
        dest: src/modules/spell/dict
        path: en_dict-20121020.tar.gz
      - type: file
        path: fcitx5.sh
    post-install:
      - install -d /app/addons
      - mv /app/bin/fcitx5{,-bin}
      - install -m755 fcitx5.sh /app/bin/fcitx5
  - name: fcitx5-qt
    buildsystem: cmake-ninja
    config-opts:
      - -DENABLE_QT4=Off
      - -DCMAKE_INSTALL_QT5PLUGINDIR=/app/lib/plugins
    sources:
      - type: archive
        url: https://github.com/fcitx/fcitx5-qt/archive/5.0.11/fcitx5-qt-5.0.11.tar.gz
        sha256: 426748e8e6514d48e0bbbb0bb85a76e786db1dd4a7cb8ed276c0d23179642882
        x-checker-data:
          type: anitya
          project-id: 138234
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5-qt/archive/$version/fcitx5-qt-$version.tar.gz
  - name: fcitx5-configtool
    buildsystem: cmake-ninja
    builddir: true
    sources:
      - type: archive
        url: https://github.com/fcitx/fcitx5-configtool/archive/5.0.12/fcitx5-configtool-5.0.12.tar.gz
        sha256: 41216ca8d15b8cfd1e4a2aa64175650093d6daa34db7da8d3eb15b96023d30b8
        x-checker-data:
          type: anitya
          project-id: 138233
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5-configtool/archive/$version/fcitx5-configtool-$version.tar.gz
  - name: fcitx5-all-icons
    buildsystem: simple
    sources:
      - type: archive
        url: https://github.com/fcitx/fcitx5-anthy/archive/5.0.10/fcitx5-anthy-5.0.10.tar.gz
        dest: fcitx5-anthy
        sha256: 0a7667930c2fc2efa991060d728f9002479185ee186b91c7745323131f65cf58
        x-checker-data:
          type: anitya
          project-id: 174357
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5-anthy/archive/$version/fcitx5-anthy-$version.tar.gz
      - type: archive
        url: https://github.com/fcitx/fcitx5-chewing/archive/5.0.10/fcitx5-chewing-5.0.10.tar.gz
        dest: fcitx5-chewing
        sha256: 5f4802998e33649bd1c0b291be46ba4778e48dfc1067ced360b1241d73be263d
        x-checker-data:
          type: anitya
          project-id: 138243
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5-chewing/archive/$version/fcitx5-chewing-$version.tar.gz
      - type: archive
        url: https://github.com/fcitx/fcitx5-chinese-addons/archive/5.0.12/fcitx5-chinese-addons-5.0.12.tar.gz
        dest: fcitx5-chinese-addons
        sha256: 98234f7c52cca6e326e839b4001c1fe425a89c31cce3d122742ffc2929cb6e12
        x-checker-data:
          type: anitya
          project-id: 138238
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5-chinese-addons/archive/$version/fcitx5-chinese-addons-$version.tar.gz
      - type: archive
        url: https://github.com/fcitx/fcitx5-hangul/archive/5.0.8/fcitx5-hangul-5.0.8.tar.gz
        dest: fcitx5-hangul
        sha256: 4815f6193b2356ce71f9ccc71a6ab6d2e4c4db33a2b07bab221594b25723090b
        x-checker-data:
          type: anitya
          project-id: 174360
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5-hangul/archive/$version/fcitx5-hangul-$version.tar.gz
      - type: archive
        url: https://github.com/fcitx/fcitx5-kkc/archive/5.0.8/fcitx5-kkc-5.0.8.tar.gz
        dest: fcitx5-kkc
        sha256: bcc2ce56ff01f3fcc396c4637793493b2aa2a71eea364630b75ee23ddf1092a8
        x-checker-data:
          type: anitya
          project-id: 138241
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5-kkc/archive/$version/fcitx5-kkc-$version.tar.gz
      - type: archive
        url: https://github.com/fcitx/fcitx5-rime/archive/5.0.12/fcitx5-rime-5.0.12.tar.gz
        dest: fcitx5-rime
        sha256: 549da0d08681ada3cb4148a03e867764d16a514eb021c9bbdd8a2336f2626556
        x-checker-data:
          type: anitya
          project-id: 138239
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5-rime/archive/$version/fcitx5-rime-$version.tar.gz
      - type: archive
        url: https://github.com/fcitx/fcitx5-sayura/archive/5.0.6/fcitx5-sayura-5.0.6.tar.gz
        dest: fcitx5-sayura
        sha256: d51b821f437a275d0bf13a8efb07d7195886080d229411da1df3c2acb23acf8a
        x-checker-data:
          type: anitya
          project-id: 174361
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5-sayura/archive/$version/fcitx5-sayura-$version.tar.gz
      - type: archive
        url: https://github.com/fcitx/fcitx5-skk/archive/5.0.11/fcitx5-skk-5.0.11.tar.gz
        dest: fcitx5-skk
        sha256: d5f2de809ceb19f3e3796afa9e2616d453ae85ec6299874cc8c86ec76951a9c5
        x-checker-data:
          type: anitya
          project-id: 138240
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5-skk/archive/$version/fcitx5-skk-$version.tar.gz
      - type: archive
        url: https://github.com/fcitx/fcitx5-table-extra/archive/5.0.9/fcitx5-table-extra-5.0.9.tar.gz
        dest: fcitx5-table-extra
        sha256: 8bf92507dabf396303e488dd5c527ade63c2f221637ed6baf4535834855182b5
        x-checker-data:
          type: anitya
          project-id: 174362
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5-table-extra/archive/$version/fcitx5-table-extra-$version.tar.gz
      - type: archive
        url: https://github.com/fcitx/fcitx5-table-other/archive/5.0.8/fcitx5-table-other-5.0.8.tar.gz
        dest: fcitx5-table-other
        sha256: 189760b39c0db2a5a4668b6f669e524929ad6e0b98f7d1b383550cdc6804aeed
        x-checker-data:
          type: anitya
          project-id: 180080
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5-table-other/archive/$version/fcitx5-table-other-$version.tar.gz
      - type: archive
        url: https://github.com/fcitx/fcitx5-unikey/archive/5.0.9/fcitx5-unikey-5.0.9.tar.gz
        dest: fcitx5-unikey
        sha256: e16fc7ef34716f634163af82e999f0f260196fbf4bbefaa7a382a5d3864c1073
        x-checker-data:
          type: anitya
          project-id: 180082
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5-unikey/archive/$version/fcitx5-unikey-$version.tar.gz
      - type: archive
        url: https://github.com/fcitx/fcitx5-zhuyin/archive/5.0.8/fcitx5-zhuyin-5.0.8.tar.gz
        dest: fcitx5-zhuyin
        sha256: 174b381f3d0506da96228b593b214dc533fbdb2fd817adae37fb18491985afbd
        x-checker-data:
          type: anitya
          project-id: 180079
          stable-only: true
          url-template: https://github.com/fcitx/fcitx5-zhuyin/archive/$version/fcitx5-zhuyin-$version.tar.gz
      - type: git
        url: https://github.com/fcitx/mozc.git
        branch: fcitx
        commit: 0b76eb6c1b8119d5aca5e3bc953fb2be18c94f74
        dest: mozc
      - type: file
        path: install_icons
    build-commands:
      - ./install_icons
      - cd mozc/src && PREFIX=${FLATPAK_DEST} ../scripts/install_fcitx5_icons
